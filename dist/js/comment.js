define(function(e,t,n){function o(e,t,n){(1===arguments.length||isNaN(t)||t<0)&&(t=v),t=Math.round(100*t)/100,t=Math.max(.01,t),t=Math.min(v,t),n=arguments.length<3?g.easeOut:n,n=n?" "+n:"",e.style[l]=a.CSSTransform+n+" "+t+"s"}function i(e){e.style[l]="none"}function r(e,t){e&&("string"==typeof e?(document.querySelectorAll(e).forEach(function(e){c(e)}),r.refresh()):e instanceof HTMLElement&&c(e,t))}function c(e){function t(){if(C){var e=C.querySelectorAll(".selected");e&&[].forEach.call(e,function(e){e.classList.remove("selected")}),(e=C.children[A])&&(e.className="selected",e.classList.add("selected"))}}function n(t,n,r,c){var a,s,l;if(t=B?(t%y+y)%y:t>=y?y-1:t<0?0:t,t!==A&&r!==!1&&(a={currentIndex:t,lastIndex:A,current:x[t],changeType:c}),x[t]){if(a&&(s=e.fireEvent("beforeChange",a))&&(s.defaultPrevented||s.returnValue===!1))return void e.back();1===arguments.length||n?(l=n||v,o(e,l)):i(e),e.scrollTo(x[t].left,x[t].top)}m=T=0,l=Math.round(1e3*Math.min(l||0,v)),t!==A&&(A=t,b=A,a&&(l?setTimeout(function(){e.fireEvent("changed",a)},l):e.fireEvent("changed",a)))}function r(t){if(t=B?(t%y+y)%y:t>=y?y-1:t<0?0:t,t!==A){var n,o={currentIndex:t,lastIndex:A,current:x[t]};if(o&&(n=e.fireEvent("beforeChange",o))&&(n.defaultPrevented||n.returnValue===!1))return e.back(),!1}return!0}function c(){document.removeEventListener(Event.Touch.up,l),document.removeEventListener(Event.Touch.move,a),document.removeEventListener(Event.Touch.cancel,E)}function a(t){if(Event.Touch.isMsPrimary(t)&&S){var n,o,i;if(n=(n=t.touches)?n[0]:t,D=n,m=e.left=n.pageX-z,T=e.top=n.pageY-q,o=Math.abs(m),i=Math.abs(T),!O)if("vertical"===N){if(o>h&&o-i>0)return void(S=0);O=i>h&&i-o>0}else{if(i>h&&i-o>0)return void(S=0);O=o>h&&o-i>0}O&&(e.scrollTo(m+x[A].left,T+x[A].top),(o>1||i>1)&&(I=1,Event.preventDefault(t)))}}function l(t){if(Event.Touch.isMsPrimary(t)){var n,o,i,r,a;S&&O&&(n=(n=t.touches)?n[0]:t,n=n||D,o=n.pageX-z,i=n.pageY-q,r="vertical"===N?i:o,a=x[A].offsetWidth,r>20?e.previous(Math.max(Math.min(v,(a-r)*v/a),.01),"swipe-previous"):r<-20?e.next(Math.max(Math.min(v,(a+r)*v/a),.01),"swipe-next"):e.back(),I=1),S=0,O=0,I&&Event.preventDefault(t),c()}}function E(){e.back(),c()}var m,T,b,w,L,x,M,y,C,B=e.getAttribute("data-loop"),A=parseInt(arguments[1]),N="horizontal",k=e;if(B="cloned"===B?"cloned":p&&"false"!==B&&"no"!==B&&"0"!==B,B||k.setAttribute("touch","false"),isNaN(A)&&(A=parseInt(e.getAttribute("data-initial-index"))),(C=e.querySelector(".container"))&&(e=C,C=0,k.querySelectorAll(".tabs").every(function(t){return!!e.contains(t)||(C=t,!1)}),C&&(e.addEventListener("changed",t),isNaN(A)&&(A=0,C&&[].forEach.call(C.children,function(e,t){e.classList.contains("selected")&&(A=t),e.addEventListener(window.navigator.msPointerEnabled?"click":"tap",function(e){n(t),e.preventDefault()})})),t())),A=A||0,M=e,x="TABLE"===e.tagName?e.rows.length>1?e.rows:(M=e.rows[0]).cells:e.children,y=x.length,!(y<2)){if(o(e),B&&("cloned"===B?(w=x[y-1],L=x[0]):(w=x[0].cloneNode(!0),L=x[y-1].cloneNode(!0),M.insertBefore(L,M.firstChild),M.appendChild(w))),k.refresh=e.refresh=function(){M=e;var t;if(t="TABLE"===e.tagName?e.rows.length>1?e.rows:(M=e.rows[0]).cells:e.children,B?(x=[],[].forEach.call(t,function(e){e===w||e===L||x.push(e)})):x=t,y=x.length,!(y<2)){var o=x[0].getBoundingClientRect(),i=x[1].getBoundingClientRect();N=i.top>=o.top+o.height?"vertical":"horizontal",e.style.msTouchAction="vertical"===N?"pan-x":"pan-y";var r=e.getBoundingClientRect();if(B&&w&&L){var c=w.getBoundingClientRect();w.left=0-w.offsetLeft||r.left-c.left,w.top=0-w.offsetTop||r.top-c.top,c=L.getBoundingClientRect(),L.left=0-L.offsetLeft||r.left-c.left,L.top=0-L.offsetTop||r.top-c.top}var r=e.getBoundingClientRect();[].forEach.call(x,function(e){var t=e.getBoundingClientRect();e.left=0-e.offsetLeft||r.left-t.left,e.top=0-e.offsetTop||r.top-t.top}),n(A,!1)}},!e.orientation){var P={orientation:{get:function(){return N},set:function(){}},go:{value:function(e,t,o){n.call(this,e,t,o)}},index:{get:function(){return A},set:function(e){n.call(this,e)}}};Object.defineProperties(e,P),Object.defineProperties(k,P)}var R=document.createElement("div");document.body.appendChild(R),R.style.cssText="width:10px;height:1px;color:#fff;overflow:hidden;pointer-events:none",k.scrollTo=e.scrollTo=function(t,n,o){o===!1&&i(e),"vertical"===N?(n=n?n+"px":0,t=0):(t=t?t+"px":0,n=0),e.style[s]="translate"+(u?"3d":"")+"("+t+","+n+(u?",0":"")+")",R.innerHTML=t+n+o},k.back=e.back=function(){var t=x[A].getBoundingClientRect(),n=Math.abs(("vertical"===N?(x[A].top+t.top)/t.height:(x[A].left+t.left)/t.width)*v);n=Math.max(n,.1),o(e,n,g.back),e.scrollTo(x[A].left,x[A].top)},k.previous=e.previous=function(t,o){var c=A-1;r(c)&&(c>=0||!w?n(c,t,0,o):(i(e),e.scrollTo(w.left+m,w.top+T),setTimeout(function(){n(-1,t,0,o)},0)))},k.next=e.next=function(t,o){var c=A+1;r(c)&&(c<y||!L?n(c,t,0,o):(i(e),e.scrollTo(L.left+m,L.top+T),setTimeout(function(){n(0,t,0,o)},0)))},d&&e.addEventListener("click",function(e){if(I)return Event.preventDefault(e),!1});var I,S,z,q,D,O;return e.addEventListener(Event.Touch.down,function(e){Event.Touch.isMsPrimary(e)&&(c(),d&&Event.preventDefault(e),I=O=0,e.touches&&(e=e.touches[0]),e&&(S=1,z=e.pageX,q=e.pageY,D=e,i(this),document.addEventListener(Event.Touch.up,l),document.addEventListener(Event.Touch.move,a),Event.Touch.cancel&&document.addEventListener(Event.Touch.cancel,E)))}),f.push(e),k}}var a=t,s=a.transform,l=a.transition,u=a.translate3d&&!/MiuiBrowser/i.test(navigator.userAgent)&&!/GT\-\w?\d+/i.test(navigator.userAgent),f=[],d=!Event.touchEnabled||"MSPointerUp"===Event.Touch.up,v=.3,h=2,p=!a.os.ios||a.os.majorVersion<7,g={quadratic:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",circular:"cubic-bezier(0.1, 0.57, 0.1, 1)",easeOut:"ease-out",back:"cubic-bezier(0.175, 0.885, 0.32, 1.275)"};return r.refresh=function(){f.forEach(function(e){Function.isFunction(e.refresh)&&e.refresh()})},window.addEventListener("orientationchange",r.refresh),window.addEventListener("resize",r.refresh),window.addEventListener("load",r.refresh),Object.defineProperties(r,{instances:{value:f,writable:!1},duration:{get:function(){return v},set:function(e){(e=parseInt(e))&&e>=0&&(v=e)}}}),a.ready(function(){r(".flipview")}),a.FlipView=r,r});
var globalWidgt={error:function(i){this.toptips||(this.toptips=document.createElement("div"),this.toptips.className="weui_toptips weui_warn js_tooltips",this.append(this.toptips)),this.toptips.innerHTML=i,this.toptips.style.display="block",this.errorTimer&&clearTimeout(this.errorTimer),this.errorTimer=setTimeout(function(){globalWidgt.toptips.style.display="none"},3e3)},toast:function(i,a,e){function t(i){return'<p class="weui_toast_content">'+i+"</p>"}var s='<div class="weui_loading"><div class="weui_loading_leaf weui_loading_leaf_0"></div><div class="weui_loading_leaf weui_loading_leaf_1"></div><div class="weui_loading_leaf weui_loading_leaf_2"></div><div class="weui_loading_leaf weui_loading_leaf_3"></div><div class="weui_loading_leaf weui_loading_leaf_4"></div><div class="weui_loading_leaf weui_loading_leaf_5"></div><div class="weui_loading_leaf weui_loading_leaf_6"></div><div class="weui_loading_leaf weui_loading_leaf_7"></div><div class="weui_loading_leaf weui_loading_leaf_8"></div><div class="weui_loading_leaf weui_loading_leaf_9"></div><div class="weui_loading_leaf weui_loading_leaf_10"></div><div class="weui_loading_leaf weui_loading_leaf_11"></div></div>',l='<i class="weui_icon_toast"></i>';if(this._toast||(this._toast=document.createElement("div"),this._toast.innerHTML='<div class="weui_mask_transparent"></div><div class="weui_toast"></div>',this.append(this._toast)),a){var o=this._toast.querySelector(".weui_toast");switch(i){case"loading":this._toast.className="weui_loading_toast",o.innerHTML=s+t(e);break;default:this._toast.className="",o.innerHTML=l+t(e);var d=this._toast;setTimeout(function(){d.style.display="none"},1e3)}this._toast.style.display="block"}else this._toast.style.display="none"},alert:function(){},confirm:function(i,a){this.dialogConfirm||(this.dialogConfirm=document.createElement("div"),this.dialogConfirm.className="weui_dialog_confirm",this.dialogConfirm.innerHTML='<div class="weui_mask"></div><div class="weui_dialog"><div class="weui_dialog_hd"><strong class="weui_dialog_title">卡车之家温馨提示</strong></div><div class="weui_dialog_bd confirm-content">empty</div><div class="weui_dialog_ft"><a href="javascript:;" class="weui_btn_dialog default">取消</a><a href="javascript:;" class="weui_btn_dialog primary">确定</a></div></div>',this.append(this.dialogConfirm),this.dialogConfirm.addEventListener("click",function(i){var e=i.target;"A"==e.tagName&&(e.classList.contains("primary")&&a&&Function.isFunction(a)&&a(),globalWidgt.dialogConfirm.style.display="none")})),this.dialogConfirm.querySelector(".confirm-content").innerHTML=i,this.dialogConfirm.style.display="block"},append:function(i){document.body.appendChild(i)}};
function commentWidget(e){this.defaults={selector:document.querySelector("#comment"),counter:null,emojiclassName:"emoji",emojiSelector:document.querySelector("#emoji"),message:"message",callback:null};for(var t in e)this.defaults[t]=e[t];this.generate()}commentWidget.prototype={generate:function(){var e=this.defaults.selector,t=this;this.message=e.elements[this.defaults.message],this.callback=this.defaults.callback,e.addEventListener("click",function(e){var s=e.target;s.classList.contains(t.defaults.emojiclassName)?t.toggleEmoji(s):(s.dataset.title||s.parentElement.dataset.title)&&t.insert(s)}),e.addEventListener("submit",function(e){t.submit(e)}),this.message.addEventListener("input",function(e){t.enabled()})},init:function(){this.message.value="",this.message.blur(),this.defaults.counter&&(this.defaults.counter.innerHTML=0),this.defaults.emojiSelector.classList.remove("visible"),this.emojibtn&&this.emojibtn.classList.contains("selected")&&this.emojibtn.classList.remove("selected")},onFocusHandle:function(e){this.init(),e&&(this.message.value="回复 "+e+"："),this.message.focus()},toggleEmoji:function(e){var t=this.defaults.emojiSelector;e.classList.toggle("selected"),t.classList.toggle("visible"),t.firstElementChild.refresh&&t.firstElementChild.refresh(),!this.emojibtn&&(this.emojibtn=e)},insert:function(e){"I"==e.tagName&&(e=e.parentElement);var t=(this.defaults.counter,e.dataset.title);this.message.value.length+t.length>500||(this.message.value+=t,this.enabled())},tally:function(){var e=this;counter=this.defaults.counter,this.message.addEventListener("input",function(t){counter&&(counter.innerHTML=this.value.length),e.enabled()})},enabled:function(){var e=this.defaults.selector.querySelector('input[type="submit"]');e&&(e.disabled=!(this.message.value.trim().bytes>=4))},submit:function(e){e.preventDefault();var t=this,s=this.defaults.selector,i=s.querySelector('input[type="submit"]');i.disabled=!0,globalWidgt.toast("loading",!0,"发表中，请稍后"),$.ajax({type:s.method,url:s.action,data:s.data,dataType:"json",success:function(e){if(e)switch(globalWidgt.toast("loading",!1),e.status){case 1:globalWidgt.toast("infor",!0,"发表成功！"),t.callback&&Function.isFunction(t.callback)&&t.callback(e.data),t.init();break;case 2:globalWidgt.error("亲，您的账号已被禁言"),t.init();break;default:i.disabled=!1,globalWidgt.error("发表失败，请稍后重试")}},error:function(){globalWidgt.toast("loading",!1),globalWidgt.error("网络不给力，请稍后重试")}})}};
HTMLElement.prototype.parents=function(e){for(var t,a=this;(a=a.parentNode)&&9!==a.nodeType;)if(1===a.nodeType){if(a.tagName.toLowerCase()===e){t=a;break}if(e.startsWith(".")&&a.classList.contains(e.replace(/\./,""))){t=a;break}if(e.startsWith("#")&&"#"+a.id===e){t=a;break}}return t};
var topicComment=new commentWidget({callback:function(){}}),comments_list=document.querySelector("#comments_list");comments_list.addEventListener("click",function(e){var t=e.target;"SPAN"==t.tagName&&"reply"==t.className&&topicComment.onFocusHandle(t.parents("li").querySelector(".nickname").innerHTML)});